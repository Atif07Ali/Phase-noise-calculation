# Phase Noise Estimation from Ngspice Transient Output

This repository contains a Python script to estimate **single-sideband (SSB) phase noise** from **transient simulation data**, such as that generated by **Ngspice**. The method applies FFT and Power Spectral Density (PSD) analysis to voltage vs. time data, enabling post-processing of oscillator phase noise at arbitrary frequency offsets.

---

## ðŸ“Œ Features

- Reads `.txt` files with alternating time and voltage values
- Applies Hanning window with proper RMS normalization
- Computes FFT and PSD (in VÂ²/Hz and dBVÂ²/Hz)
- Locates the carrier peak and evaluates phase noise at **Â±1â€¯MHz offset**
- Selects the **worst-case (higher PSD)** sideband
- Plots both **FFT magnitude** and **PSD** with annotations
- Reports phase noise in **dBc/Hz**

---

## ðŸ§  Algorithm Overview

1. **Preprocessing**
   - Remove DC offset
   - Apply Hanning window
   - Compute RMS correction gain

2. **FFT and PSD Calculation**
   - Normalize FFT magnitude
   - Compute one-sided PSD:  
     \[
     \text{PSD}(f) = \frac{|V(f)|^2}{\Delta f}
     \]

3. **Carrier & Offset Analysis**
   - Find carrier peak (max magnitude)
   - Estimate carrier power from 3-bin PSD sum
   - Measure PSD at Â±1â€¯MHz offset and compute:  
     \[
     L(f_{\text{offset}}) = 10 \log_{10}\left(\frac{\text{PSD}_{\text{offset}}}{\text{Carrier Power}}\right)
     \]

4. **Plotting**
   - FFT Magnitude Spectrum
   - PSD (in dBVÂ²/Hz) with peak and offset bins annotated
